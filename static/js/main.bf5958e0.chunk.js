(this["webpackJsonpbp-demo"]=this["webpackJsonpbp-demo"]||[]).push([[0],{181:function(t,e,a){},576:function(t,e,a){},581:function(t,e){},582:function(t,e){},590:function(t,e){},593:function(t,e){},594:function(t,e){},597:function(t,e,a){},598:function(t,e,a){"use strict";a.r(e);var r={};a.r(r),a.d(r,"formatWeightArray",(function(){return Bt})),a.d(r,"toFunc2DArray",(function(){return Et})),a.d(r,"flatten",(function(){return Mt})),a.d(r,"getRandomInt",(function(){return Dt})),a.d(r,"tensorToArray",(function(){return Pt}));var n={};a.r(n),a.d(n,"generateLinearScale",(function(){return Wt})),a.d(n,"generateLink",(function(){return Rt})),a.d(n,"generateNeuronPlacement",(function(){return zt})),a.d(n,"generateLinksPlacement",(function(){return _t}));var i=a(8),s=a.n(i),o=a(61),c=a.n(o),l=a(5),h=a(11),d=a(14),u=a(15),j=a(270),b=a(397),p=a(636),x=a(36),f=(a(181),a(1)),m=function(t){var e=t.source,a=t.target,r=t.color,n=t.isAnimating;return Object(f.jsxs)("g",{children:[Object(f.jsx)("defs",{children:Object(f.jsx)("marker",{id:"head",orient:"auto",markerWidth:"3",markerHeight:"4",refX:"0.1",refY:"2",children:Object(f.jsx)("path",{d:"M0,0 V4 L2,2 Z",fill:r})})}),Object(f.jsx)("path",{className:n?"absorb":"arrow",id:"arrow-line",markerEnd:"url(#head)",fill:"none",stroke:r,d:"M".concat(e.x,",").concat(e.y,", ").concat(a.x,", ").concat(a.y)})]})},y=function(t){var e=function(t){return"undefined"===typeof t},a=function(t,a,r,n){return e(t[a])||e(t[a][r])||e(t[a][r][n])},r=function(t,e,a,r,n){var i=r?-a:a;return Object(f.jsx)(m,{source:{x:t,y:e},target:{x:t,y:e+i},color:n,isAnimating:"transition"===h})},n=t.playing,i=t.mode,s=t.shapedLinks,o=t.shapedWeights,c=t.shapedRects,l=t.miniNN,h=t.subEpoch,d=t.keyFrameLoss,u=t.keyFrameLayer,j=t.lr,b=t.isAnimating,p="orange",y="black",g=32,O=x.m().x((function(t){return t.x})).y((function(t){return t.y})),v=Object(f.jsx)("svg",{id:"p",width:"810",height:"500",overflow:"visible",children:Object(f.jsxs)("g",{id:"ee",children:[Object(f.jsx)("path",{d:"M 750, 234 L 750, 300",stroke:2===d||1===d?p:y,className:i&&d>0?1===d?"edgeForward":2===d?"edgeBackward":"edgePaused":n}),Object(f.jsx)("path",{d:O({source:{x:766,y:315},target:{x:890,y:430}}),stroke:y,fill:"none",className:n}),Object(f.jsx)("path",{d:O({source:{x:766,y:250},target:{x:890,y:150}}),stroke:y,fill:"none",className:n}),s.map((function(t,e){return t.map((function(t,r){var s="edgePaused",c=!1;return i&&"forward"===h&&e===u?(s="edgeForward",c=!0):i&&"backward"===h&&e===u&&(s="edgeBackward",c=!0),t.map((function(t,d){var u=a(o,e,r,d),j=u?[]:o[e][r][d],p=u?1:2*Math.abs(j)+.1,m=u?"lightgrey":j>0?"#4BA3C3":"#D62839";if(i&&"update"===h&&!0===b){var y=2*l.model[e][r].dWeights[d],g=.01*y;x.t("#nn").select("#p").select("#ee").select("#cpath".concat(e).concat(r).concat(d)).transition().duration(750).ease(x.g).attr("stroke-width",p-y).transition().duration(750).ease(x.h).attr("stroke-width",p-g)}return Object(f.jsx)("path",{id:"cpath".concat(e).concat(r).concat(d),d:t,className:i?s:n,strokeWidth:p,stroke:c?"orange":m,fill:"none"},"".concat(e).concat(r).concat(d))}))}))})),Object(f.jsx)("rect",{x:55,y:234,width:g,height:g,fill:"darkgrey"}),c.map((function(t,e){return t.map((function(t,a){var n=!1,s="backward"===h||"transition"===h;return(i&&e<=u||s||"update"===h)&&(n=!0),Object(f.jsxs)("g",{children:[Object(f.jsx)("rect",{x:t.x,y:t.y,width:g,height:g,fill:734===t.x&&234===t.y&&i?"#C6C6C6":x.q(104,104,104).brighter(n?l.model[e][a].actStep+j:1),stroke:734===t.x&&234===t.y?"#507BB6":"black",strokeWidth:3}),null!==l&&i&&s&&e>=u-1&&0!==l.model[e][a].dActStep?r(t.x+16,t.y+16,Math.abs(l.model[e][a].dActStep),l.model[e][a].dActStep<0,p):""]},"".concat(e,",").concat(a))}))})),Object(f.jsx)("rect",{x:734,y:300,width:g,height:g,fill:"none",stroke:"black"}),Object(f.jsx)("text",{fontFamily:"sans-serif",fontSize:"12px",x:739,y:318,children:"loss"})]})});return Object(f.jsx)("div",{id:"nn",children:v})},g=a(3),O=a.n(g),v=a(13),w=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(){return Object(l.a)(this,a),e.apply(this,arguments)}return Object(h.a)(a,[{key:"plotPoints",value:function(t,e,a){t.selectAll("circle").data(e).enter().append("circle").attr("cx",(function(t){return t.x})).attr("cy",(function(t){return t.y})).attr("r",(function(t,e){return e===a?5:2})).style("fill",(function(t,e){return e===a?"orange":"grey"}))}},{key:"generateScales",value:function(t,e,a,r,n){return{xScale:x.r().domain([t,e]).range([0,a-2*n]),yScale:x.r().domain([t,e]).range([r-2*n,0])}}},{key:"componentDidMount",value:function(){var t=Object(v.a)(O.a.mark((function t(){var e,a,r,n,i,s,o,c,l,h,d,u,j,b;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.props,a=e.width,r=e.height,n=e.padding,i=e.start,s=e.stop,o=e.id,c=x.t("#scatter".concat(o)),(l=c.append("svg").attr("width",a).attr("height",r).style("overflow","visible")).append("rect").attr("width",a).attr("height",r).attr("class","cord"),h=this.generateScales(i,s,a,r,n),d=h.xScale,u=h.yScale,j=x.a().scale(d),b=x.c().scale(u),l.append("g").attr("class","axis").attr("transform","translate(0,".concat(r-2*n,")")).call(j),l.append("g").attr("class","axis").attr("transform","translate("+(a-2*n)+",0)").call(b),l.append("line").attr("x1",0).attr("y1",(r+1)/2).attr("x2",a).attr("y2",(r+1)/2).attr("class","split"),l.append("line").attr("x1",(a+1)/2).attr("y1",0).attr("x2",(a+1)/2).attr("y2",r).attr("class","split"),l.append("path").attr("id","scatterline").attr("stroke","none").attr("fill","none");case 12:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){for(var t=this.props,e=t.width,a=t.height,r=t.padding,n=t.start,i=t.stop,s=t.X,o=t.y,c=t.yhat,l=t.id,h=t.select,d=t.duration,u=this.generateScales(n,i,e,a,r),j=u.xScale,b=u.yScale,p=x.t("#scatter".concat(l)).select("svg"),f=[],m=[],y=0;y<s.length;y++)f.push({x:j(s[y]),y:b(o[y])}),m.push([j(s[y]),b(c[y])]);p.selectAll("circle").remove(),this.plotPoints(p,f,h),p.select("#scatterline").transition().duration(d).attr("d",x.l()(m)).attr("stroke","black").attr("fill","none")}},{key:"render",value:function(){var t=this.props.id;return Object(f.jsx)("div",{id:"scatter".concat(t)})}}]),a}(i.Component),k=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(){return Object(l.a)(this,a),e.apply(this,arguments)}return Object(h.a)(a,[{key:"plotPoints",value:function(t,e,a){var r={x:this.props.X[a],y:this.props.y[a]},n=function(t,e){return t===e},i="#4BA3C3",s=5,o="grey",c=2;t.selectAll("circle").data(e).enter().append("circle").attr("cx",(function(t){return t.x})).attr("cy",(function(t){return t.y})).attr("r",(function(t,e){return n(e,a)?s:c})).style("fill",(function(t,e){return n(e,a)?i:o})),t.append("text").attr("x",e[a].x+10).attr("y",e[a].y).attr("fill",i).attr("font-size","12px").text("(".concat(r.x.toFixed(2),",").concat(r.y.toFixed(2),")"))}},{key:"generateScales",value:function(t,e,a,r,n){return{xScale:x.r().domain([t,e]).range([0,a-2*n]),yScale:x.r().domain([t,e]).range([r-2*n,0])}}},{key:"animateLineChange",value:function(t,e,a,r,n){t.attr("d",x.l()(a)).attr("stroke",e).attr("fill","none"),t.transition().duration(n).attr("d",x.l()(r))}},{key:"componentDidMount",value:function(){var t=Object(v.a)(O.a.mark((function t(){var e,a,r,n,i,s,o,c,l,h,d,u,j,b;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.props,a=e.width,r=e.height,n=e.padding,i=e.start,s=e.stop,o=e.id,c=x.t("#animatedPlot".concat(o)),(l=c.append("svg").attr("width",a).attr("height",r).style("overflow","visible")).append("rect").attr("width",a).attr("height",r).attr("class","cord"),h=this.generateScales(i,s,a,r,n),d=h.xScale,u=h.yScale,j=x.a().scale(d),b=x.c().scale(u),l.append("g").attr("class","axis").attr("transform","translate(0,".concat(r-2*n,")")).call(j),l.append("g").attr("class","axis").attr("transform","translate("+(a-2*n)+",0)").call(b),l.append("line").attr("x1",0).attr("y1",(r+1)/2).attr("x2",a).attr("y2",(r+1)/2).attr("class","split"),l.append("line").attr("x1",(a+1)/2).attr("y1",0).attr("x2",(a+1)/2).attr("y2",r).attr("class","split"),l.append("path").attr("id","scatterline").attr("stroke","none").attr("fill","none");case 12:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"updateAll",value:function(){for(var t=this.props,e=t.width,a=t.height,r=t.padding,n=t.start,i=t.stop,s=t.X,o=t.y,c=t.yhat,l=t.id,h=t.select,d=t.potential,u=this.generateScales(n,i,e,a,r),j=u.xScale,b=u.yScale,p=x.t("#animatedPlot".concat(l)).select("svg"),f=[],m=[],y=[],g=[],O=0;O<s.length;O++){f.push({x:j(s[O]),y:b(o[O])});var v=j(s[O]);m.push([v,b(c[O])]),g.push([v,b(d[O])]),y.push([v,b(0)])}p.selectAll("circle").remove(),p.selectAll("text").remove();var w=p.select("#scatterline");this.plotPoints(p,f,h),"reset"===this.props.status?w.attr("id","scatterline").attr("stroke","none").attr("fill","none"):"real"===this.props.status?this.animateLineChange(w,"black",y,m,750):"pred"===this.props.status&&this.animateLineChange(w,"orangered",m,g,750)}},{key:"componentDidUpdate",value:function(){this.updateAll()}},{key:"shouldComponentUpdate",value:function(){return!this.props.shouldNotRender}},{key:"render",value:function(){var t=this.props.id;return Object(f.jsx)("div",{id:"animatedPlot".concat(t)})}}]),a}(i.Component),S=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(){return Object(l.a)(this,a),e.apply(this,arguments)}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var t=x.t("#sweet"),e=100,a=300,r=x.r().domain([0,-1]).range([0,300]),n=x.r().domain([1,1]).range([100,0]),i=t.append("svg").attr("width",a).attr("height",e).style("overflow","visible");i.append("rect").attr("width",a).attr("height",e).attr("class","cord");var s=x.a().scale(r),o=x.c().scale(n);i.append("g").attr("class","axis").attr("id","x").attr("transform","translate(0,".concat(100,")")).call(s),i.append("g").attr("class","axis").attr("id","y").attr("transform","translate(300,0)").call(o.ticks(0)),i.append("path").attr("id","line").attr("stroke","none").attr("fill","none")}},{key:"componentDidUpdate",value:function(){for(var t=this.props,e=t.lossArray,a=t.duration,r=e.length-1,n=x.r().domain([0,r]).range([1,300]),i=x.o(e),s=x.n(e),o=x.r().domain([i,s]).range([100,0]),c=x.t("#sweet").select("svg"),l=[],h=0;h<e.length;h++)l.push([n(h),o(e[h])]);var d=x.a().scale(n),u=x.c().scale(o);c.select("#x").transition().duration(a).attr("transform","translate(0,".concat(100,")")).call(d.ticks(5)),c.select("#y").transition().duration(a).attr("transform","translate(300,0)").call(u.ticks(5)),c.select("#line").transition().duration(a).attr("d",x.l()(l)).attr("stroke","black").attr("fill","none")}},{key:"render",value:function(){return Object(f.jsx)("div",{id:"sweet"})}}]),a}(i.Component),C=(a(567),a(267)),A=function(t){return Object(f.jsx)(C.InlineMath,{math:t})},F=function(t){return Object(f.jsx)(C.BlockMath,{math:t})},T=a(626),L=a(640),B=a(615),E=a(617),M=a(618),D=a(638),P=a(628),W=a(621),R=a(622),z=a(629),_=a(630),N=a(58),q=a(50),I=a(43);a(576);function U(t){var e=t.node,a=t.xScale,r=t.yScale,n=t.width,i=(t.height,t.ticks),s=void 0===i?10:i,o=t.padding,c=void 0===o?0:o,l=x.d().scale(a),h=x.b().scale(r);e.select("#xAxis-contour").attr("class","axis").attr("transform","translate(0,0)").call(l.ticks(s)),e.select("#yAxis-contour").attr("class","axis").attr("transform","translate("-(n-2*c)+",0)").call(h.ticks(s))}function X(t){var e=t.node,a=t.m,r=void 0===a?[[0,0],[0,0]]:a,n=t.b,i=void 0===n?[[0,0],[0,0]]:n,s=t.stroke,o=void 0===s?"none":s,c=t.mStroke,l=void 0===c?o:c,h=t.bStroke,d=void 0===h?o:h;e.select("#m-line").attr("x1",r[0][0]).attr("y1",r[0][1]).attr("x2",r[1][0]).attr("y2",r[1][1]).attr("class","line").attr("id","m-line").style("stroke",l),e.select("#b-line").attr("x1",i[0][0]).attr("y1",i[0][1]).attr("x2",i[1][0]).attr("y2",i[1][1]).attr("id","b-line").attr("class","line").style("stroke",d)}function G(t,e){var a=e.x,r=void 0===a?0:a,n=e.y,i=void 0===n?0:n,s=e.hidden,o=void 0===s||s,c=e.text,l=void 0===c?"none":c,h=e.textColor,d=void 0===h?"red":h,u=e.rectFillColor,j=void 0===u?"hsla(0, 0%, 100%, 0.5)":u,b=r+10,p=i+10;t.select("#loss-rect").attr("x",b).attr("y",p).attr("width",100).attr("height",30).attr("fill",o?"none":j).attr("stroke",o?"none":d),t.select("#loss-text").attr("x",b+10).attr("y",p+20).attr("fill",o?"none":d).text(l)}var V=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(t){var r;return Object(l.a)(this,a),(r=e.call(this,t)).state={width:200,height:200},r.loss=r.loss.bind(Object(I.a)(r)),r}return Object(h.a)(a,[{key:"loss",value:function(t,e){for(var a=this.props.data,r=a.X,n=a.y,i=0,s=0;s<a.X.length;s++)i+=Math.pow(t*r[s]+e-n[s],2);return i/(2*r.length)}},{key:"componentDidMount",value:function(){var t=Object(v.a)(O.a.mark((function t(){var e,a,r,n,i,s,o,c,l,h,d,u,j,b,p,f,m,y,g,v,w,k,S,C,A,F;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.state;case 2:return e=t.sent,a=e.width,r=e.height,n=x.t("#divContour").select("#contour"),t.next=8,this.props;case 8:for(i=t.sent,i.data,s=i.darkness,o=a,c=r,l=new Array(o*c),h=[],d=[],u=.5,j=0;u<c;++u)for(b=.5;b<o;++b,++j)p=b/o*10-5,f=u/c*20,h.push(p),d.push(f),m=this.loss(p,f),l[j]=m;return y=x.i(h),g=x.i(d),v=function(t){return t[0]},w=function(t){return t[1]},t.next=20,x.p(s,20,1).map((function(t){return Math.pow(2,t)}));case 20:k=t.sent,S=x.s(x.i(k),x.k),C=x.f().size([o,c]).thresholds(k)(l),A=x.r().domain([v(y),w(y)]).range([0,a]),F=x.r().domain([v(g),w(g)]).range([0,r]),U({node:n,height:r,width:a,xScale:A,yScale:F,padding:0,ticks:10}),n.append("g").attr("fill","none").selectAll("path").data(C).join("path").attr("fill",(function(t){return S(t.value)})).attr("d",x.j()),n.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",0).attr("id","b-line").style("stroke","none"),n.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",0).attr("id","m-line").style("stroke","none"),n.append("circle").attr("cx",a/2).attr("cy",0).attr("r",5).style("fill","none").style("stoke","none"),n.append("rect").attr("id","loss-rect"),n.append("text").attr("id","loss-text"),G(n,{hidden:!0});case 32:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=this.state,e=t.width,a=t.height,r=this.props,n=r.loss,i=r.ms,s=r.m,o=r.b,c=r.wColor,l=r.bColor,h=x.t("#divContour").select("#contour");if(null==n)return h.select("circle").attr("cx",e/2).attr("cy",0).attr("r",5).style("fill","none").style("stroke","none"),X({node:h}),h.select("#m-text").attr("fill","#0000"),h.select("#b-text").attr("fill","#0000"),void G(h,{hidden:!0});if(n<1e3){var d=function(t,e){return e/2+t/10*e}(s,e),u=function(t,e){return t/20*e}(o,a);h.select("circle").transition().duration(200-i).attr("cx",d).attr("cy",u).attr("r",4).style("stroke","white").style("stroke-width",3).style("fill","red").style("opacity","1.0"),h.select("#m-text").text("w = ".concat(s.toFixed(2))).attr("x",d).attr("y",-20).attr("fill",c).style("font-weight",500),h.select("#b-text").text("b = ".concat(o.toFixed(2))).attr("x",-20).attr("y",u+5).attr("fill",l).style("font-weight",500),X({node:h,b:[[-15,u],[d,u]],m:[[d,-15],[d,u]],mStroke:x.e(c).brighter(),bStroke:x.e(l).brighter()}),G(h,{hidden:!1,text:"loss: ".concat(n.toFixed(3)),x:d,y:u})}}},{key:"render",value:function(){var t=this.state,e=t.width,a=t.height;return Object(f.jsx)("div",{id:"divContour",style:{paddingLeft:"85px",paddingTop:"40px",overflow:"visible"},children:Object(f.jsxs)("svg",{style:{width:e,height:a,overflow:"visible"},id:"contour",children:[Object(f.jsx)("g",{id:"xAxis-contour"}),Object(f.jsx)("g",{id:"yAxis-contour"}),Object(f.jsx)("text",{id:"m-text",style:{textAnchor:"middle"}}),Object(f.jsx)("text",{id:"b-text",style:{textAnchor:"end"}})]})})}}]),a}(i.Component),J=(a.p,a(619)),K=a(620),H=a(623),Y=a(624),Q=a(33),Z="#FFA500",$="#56A8C7",tt=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(t){var r;return Object(l.a)(this,a),(r=e.call(this,t)).state={yhat:[],darkness:-4,playButton:!0,linreg:{meanSquaredError:0,rsquared:null,data:{X:[],y:[]},hyperparams:{learningRate:.03,epochs:0,loss:null,speed:200},tunableparams:{m:0,b:0}}},r.generateData=r.generateData.bind(Object(I.a)(r)),r.linearRegression=r.linearRegression.bind(Object(I.a)(r)),r.a=r.a.bind(Object(I.a)(r)),r.handleSlider=r.handleSlider.bind(Object(I.a)(r)),r.reset=r.reset.bind(Object(I.a)(r)),r}return Object(h.a)(a,[{key:"reset",value:function(){this.generateData(),this.setState(Object(q.a)(Object(q.a)({},this.state),{},{playButton:!0,linreg:Object(q.a)(Object(q.a)({},this.state.linreg),{},{rsquared:null,hyperparams:Object(q.a)(Object(q.a)({},this.state.linreg.hyperparams),{},{epochs:0,loss:null}),tunableparams:{m:0,b:0}})}))}},{key:"generateData",value:function(){var t=this;Q.r((function(){var e=[0,1,2,3,4,5],a=[5,4,3,2,1,0],r=Q.q(a),n=Q.g(r).dataSync()[0],i=1/(2*e.length)*Q.o(Q.i(Q.n(n,r),2)).dataSync()[0];t.setState(Object(q.a)(Object(q.a)({},t.state),{},{yhat:[0,0,0,0,0,0],linreg:Object(q.a)(Object(q.a)({},t.state.linreg),{},{meanSquaredError:i,data:{X:e,y:a}})}))}))}},{key:"linearRegression",value:function(){var t=this;Q.r((function(){if(t.state.linreg.hyperparams.epochs>1e4)t.setState({playButton:!t.state.playButton});else{var e=t.state.linreg.tunableparams,a=e.m,r=e.b,n=t.state.linreg.hyperparams.learningRate,i=t.state.linreg.data,s=i.X,o=i.y,c=Q.q(s),l=Q.q(o),h=function(t,e,a){return Q.a(Q.h(t,e),a)}(c,a,r),d=c.shape[0],u=1/d*Q.o(Q.h(Q.n(h,l),c)).dataSync()[0],j=1/d*Q.o(Q.n(h,l)).dataSync()[0],b=function(t,e){return 1/(2*d)*Q.o(Q.i(Q.n(e,t),2)).dataSync()[0]}(l,h);a+=-n*u,r+=-n*j;var p=1-b/t.state.linreg.meanSquaredError,x=t.state.linreg.hyperparams.epochs+1,f=Array.from(h.dataSync());t.setState(Object(q.a)(Object(q.a)({},t.state),{},{yhat:f,linreg:Object(q.a)(Object(q.a)({},t.state.linreg),{},{rsquared:p,tunableparams:{m:a,b:r},hyperparams:Object(q.a)(Object(q.a)({},t.state.linreg.hyperparams),{},{epochs:x,loss:b})})}))}}))}},{key:"a",value:function(){var t=Object(v.a)(O.a.mark((function t(){var e,a,r,n;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=function(t){return new Promise((function(e){return setTimeout(e,t)}))},a=200;case 2:return r=this.state.linreg.hyperparams.speed,n=a-r,t.next=7,this.linearRegression();case 7:return t.next=9,e(n);case 9:if(!0!==this.state.playButton){t.next=11;break}return t.abrupt("break",13);case 11:t.next=2;break;case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"handleSlider",value:function(t,e){this.setState({linreg:Object(q.a)(Object(q.a)({},this.state.linreg),{},{hyperparams:Object(q.a)(Object(q.a)({},this.state.linreg.hyperparams),{},{speed:e})})})}},{key:"componentDidMount",value:function(){var t=Object(v.a)(O.a.mark((function t(){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.generateData();case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this,e=this.state.linreg.tunableparams,a=e.m,r=e.b,n=this.state.linreg.hyperparams,i=n.loss,s=n.speed,o=n.epochs,c=this.state.linreg.data,l=function(t,e){return null===t?t:t.toFixed(e)};return Object(f.jsx)("div",{children:Object(f.jsxs)(D.a,{display:"flex",justifyContent:"center",marginTop:2,children:[Object(f.jsx)(D.a,{marginTop:10,marginRight:10,children:Object(f.jsx)(w,{width:300,height:300,padding:0,start:0,stop:5,X:c.X,y:c.y,yhat:this.state.yhat,id:420,select:-1,duration:0})}),Object(f.jsx)(B.a,{variant:"outlined",children:Object(f.jsxs)(E.a,{children:[Object(f.jsxs)(M.a,{variant:"h4",component:"h2",children:["EPOCH: ",o]}),Object(f.jsxs)(M.a,{variant:"h6",children:[A("\\text{neuron}(x) = "),Object(f.jsx)("span",{style:{color:$},children:A("".concat(l(a,2)))}),A(" x\\ + \\ "),Object(f.jsx)("span",{style:{color:Z},children:A("".concat(l(r,2)))})]}),Object(f.jsx)("div",{style:{margin:"20px 10px"}}),Object(f.jsx)(J.a,{onClick:this.reset,children:Object(f.jsx)(K.a,{})}),Object(f.jsx)(W.a,{style:{background:this.state.playButton?"#175676":"#D62839",color:"white"},onClick:Object(v.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.setState({playButton:!t.state.playButton});case 2:return e.next=4,t.a();case 4:case"end":return e.stop()}}),e)}))),disableTouchRipple:!0,children:this.state.playButton?Object(f.jsx)(R.a,{}):Object(f.jsx)(H.a,{})}),Object(f.jsx)(J.a,{style:{color:200===s?"grey":"#FFC006"},onClick:function(){t.setState({linreg:Object(q.a)(Object(q.a)({},t.state.linreg),{},{hyperparams:Object(q.a)(Object(q.a)({},t.state.linreg.hyperparams),{},{speed:200===s?120:200})})})},children:Object(f.jsx)(Y.a,{})}),Object(f.jsx)("div",{style:{height:"1px",width:"100%",background:"#0001",marginTop:"25px"}}),Object(f.jsx)(V,{ms:s,data:c,m:isFinite(a)?a:0,b:isFinite(r)?r:0,loss:i,darkness:this.state.darkness,wColor:$,bColor:Z})]})})]})})}}]),a}(i.Component),et=a(641),at=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(t){var r;return Object(l.a)(this,a),(r=e.call(this,t)).state={weight:-.82,bias:-.02,loss:0,domain:[],range:[],line:[],show:!0,width:400,biasColor:"#FFA500",weightColor:"#56A8C7",lossColor:"red"},r}return Object(h.a)(a,[{key:"loss",value:function(t,e,a){return Q.r((function(){var r=Q.q(t),n=Q.q(e);return 1/(2*a)*Q.o(Q.i(Q.n(n,r),2)).dataSync()[0]}))}},{key:"computeLine",value:function(t,e,a){for(var r,n=new Array(a.length),i=0;i<a.length;i++)n[i]=(r=a[i],t*r+e);return n}},{key:"zeros",value:function(t){for(var e=new Array(t),a=0;a<t;a++)e[a]=0;return e}},{key:"range",value:function(t,e,a){for(var r=[],n=t;n<=e;n+=a)r.push(n);return r}},{key:"dataGenerator",value:function(){var t=this.range(-1,1,.1),e=this.computeLine(.65,-.3,t),a=this.computeLine(this.state.weight,this.state.bias,t),r=this.loss(e,a,e.length);this.setState({domain:t,range:e,line:a,loss:r})}},{key:"componentDidMount",value:function(){this.dataGenerator()}},{key:"render",value:function(){var t=this,e=this.state,a=e.domain,r=e.range,n=e.bias,i=e.weight,s=e.line,o=e.loss,c=e.show,l=e.width,h=e.weightColor,d=e.biasColor,u=e.lossColor;return Object(f.jsxs)(D.a,{display:"flex",justifyContent:"center",children:[Object(f.jsx)(D.a,{style:{filter:"blur(".concat(c?0:25,"px)")},children:Object(f.jsx)(w,{width:l,height:l,padding:0,start:-1,stop:1,X:a,y:r,yhat:s,id:69,select:-1,duration:0})}),Object(f.jsx)(D.a,{marginLeft:7,children:Object(f.jsx)(B.a,{variant:"outlined",children:Object(f.jsxs)(E.a,{children:[Object(f.jsxs)("p",{children:["Manually tune"," ",Object(f.jsx)("em",{style:{color:h},children:"weight"})," ","and ",Object(f.jsx)("em",{style:{color:d},children:"bias"})," ","and try to reach a"," ",Object(f.jsx)("em",{style:{color:u},children:"loss"})," of 0"]}),Object(f.jsx)(et.a,{style:{color:h},value:i,onChange:function(e,s){var o=t.computeLine(i,n,a),c=t.loss(r,o,r.length);t.setState({weight:s,line:o,loss:c})},min:-1,step:.01,max:1,valueLabelDisplay:"auto"}),Object(f.jsx)(et.a,{style:{color:d},value:n,onChange:function(e,s){var o=t.computeLine(i,n,a),c=t.loss(r,o,r.length);t.setState({bias:s,line:o,loss:c})},min:-1,step:.01,valueLabelDisplay:"auto",max:1}),Object(f.jsxs)("h3",{children:[A("\\text{neuron}(x) = ")," ",Object(f.jsx)("em",{style:{color:h},children:A("".concat(i))}),A("x + ")," ",Object(f.jsx)("em",{style:{color:d},children:A("".concat(n))})]}),Object(f.jsxs)("h3",{children:[Object(f.jsx)("i",{style:{color:u},children:"loss"})," ",A(" = \\frac{1}{J}\\sum_{i = 1}^J (\\hat{y_i} - y_i)^2 ="),Object(f.jsxs)("em",{style:{color:u},children:[" ",A("".concat(o.toFixed(7)))]})]})]})})})]})}}]),a}(i.Component),rt=a(625),nt=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(t){var r;return Object(l.a)(this,a),(r=e.call(this,t)).state={input:0,output1:0,output2:0,output3:0,weights:[],biases:[]},r.compute=r.compute.bind(Object(I.a)(r)),r.initParams=r.initParams.bind(Object(I.a)(r)),r}return Object(h.a)(a,[{key:"compute",value:function(t){var e=this.state,a=e.weights,r=e.biases,n=function(t,e,a){return e*t+a},i=n(t,a[0],r[0]).toFixed(3),s=n(i,a[1],r[1]).toFixed(3),o=n(s,a[2],r[2]).toFixed(3);this.setState({input:t,output1:i,output2:s,output3:o})}},{key:"genRandomArray",value:function(t){for(var e=new Array(t),a=0;a<e.length;a++)e[a]=+Math.random().toFixed(2);return e}},{key:"initParams",value:function(){var t=Object(v.a)(O.a.mark((function t(){var e,a;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.genRandomArray(3),a=this.genRandomArray(3),this.setState({weights:e,biases:a});case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var t=Object(v.a)(O.a.mark((function t(){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initParams();case 2:this.compute(34);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this,e=this.state,a=e.input,r=e.output1,n=e.output2,i=e.output3,s=e.weights,o=e.biases,c=a.toFixed(3),l=[{output:r,color:"#8db600"},{output:n,color:"#FF8F00"},{output:i,color:"#56A8C7"}];return Object(f.jsx)(D.a,{display:"flex",children:Object(f.jsx)(D.a,{width:580,children:Object(f.jsxs)(B.a,{variant:"outlined",children:[Object(f.jsxs)(E.a,{children:[Object(f.jsx)(et.a,{value:this.state.input,onChange:function(e,a){t.compute(a)},color:"secondary"}),Object(f.jsx)(D.a,{display:"flex",justifyContent:"center",children:Object(f.jsx)(D.a,{justifyContent:"center",children:Object(f.jsxs)("svg",{width:500,height:64,children:[Object(f.jsx)("path",{d:"M".concat(36," 16, ",100," 16"),stroke:"#f50557",strokeDasharray:"25, 4",strokeWidth:3*s[0]+.2}),Object(f.jsx)("text",{x:40,y:40,fill:"#f50557",children:c}),l.map((function(t,e){return Object(f.jsxs)("g",{children:[Object(f.jsx)("rect",{x:100+100*e,y:0,width:32,height:32,fill:"lightgrey"}),Object(f.jsx)("text",{x:111+100*e,y:22,children:e+1}),Object(f.jsx)("path",{d:"M".concat(132+100*e," 16, ").concat(200+100*e," 16"),stroke:t.color,strokeDasharray:"25, 4",strokeWidth:e<2?3*s[e+1]+.2:1}),Object(f.jsx)("text",{x:140+100*e,y:40,fill:t.color,children:t.output})]},e)}))]})})}),Object(f.jsxs)(M.a,{variant:"h5",children:["neuron1(",Object(f.jsx)(M.a,{color:"secondary",variant:"inherit",children:c}),") = ",s[0],"(",Object(f.jsx)(M.a,{color:"secondary",variant:"inherit",children:c}),") + ",o[0]," ="," ",Object(f.jsx)(M.a,{style:{color:"#8db600"},variant:"inherit",children:this.state.output1})]}),Object(f.jsxs)(M.a,{variant:"h5",children:["neuron2(",Object(f.jsx)(M.a,{style:{color:"#8db600"},variant:"inherit",children:this.state.output1}),") = ",s[1],"(",Object(f.jsx)(M.a,{style:{color:"#8db600"},variant:"inherit",children:this.state.output1}),") + ",o[1]," ="," ",Object(f.jsx)(M.a,{style:{color:"#FF8F00"},variant:"inherit",children:this.state.output2})]}),Object(f.jsxs)(M.a,{variant:"h5",children:["neuron3(",Object(f.jsx)(M.a,{style:{color:"#FF8F00"},variant:"inherit",children:this.state.output2}),") = ",s[2],"(",Object(f.jsx)(M.a,{style:{color:"#FF8F00"},variant:"inherit",children:this.state.output2}),") + ",o[2]," ="," ",Object(f.jsx)(M.a,{style:{color:"#56A8C7"},variant:"inherit",children:this.state.output3})]})]}),Object(f.jsx)(rt.a,{children:Object(f.jsx)(T.a,{size:"small",variant:"outlined",style:{borderColor:"#175676",color:"#175676"},onClick:Object(v.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initParams();case 2:case"end":return e.stop()}}),e)}))),children:"new Weights and biases"})})]})})})}}]),a}(i.Component),it=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(t){var r;return Object(l.a)(this,a),(r=e.call(this,t)).state={key:!1},r}return Object(h.a)(a,[{key:"render",value:function(){var t=this,e=this.state.key,a=this.props,r=a.noKeySVG,n=a.keySVG,i=a.title;return Object(f.jsx)("div",{children:Object(f.jsx)(B.a,{variant:"outlined",children:Object(f.jsxs)(E.a,{children:[i,Object(f.jsx)("img",{width:"100%",src:e?n:r,alt:""}),Object(f.jsx)(T.a,{onClick:function(){t.setState({key:!e})},variant:"outlined",style:{borderColor:"#175676",color:"#175676"},children:"Click here to see descriptions of the diagram above"})]})})})}}]),a}(i.Component),st=a.p+"static/media/summary.c45974a2.svg",ot=a.p+"static/media/forward-key.faefbb8b.svg",ct=a.p+"static/media/forward.ff39da98.svg",lt=a.p+"static/media/forwardComputation.42bcf438.svg",ht=a.p+"static/media/backward-key.af99d48b.svg",dt=a.p+"static/media/backward.6cd01f92.svg",ut=a.p+"static/media/backwardComputation.6427121a.svg",jt=a.p+"static/media/contour-explain.00defcff.svg",bt=a.p+"static/media/gd-explain.8aebb83e.svg",pt=function(){var t,e,a="#FFA500",r="#56A8C7",n=Object(f.jsx)("em",{style:{color:a},children:"orange"}),i=Object(f.jsx)("em",{style:{color:r},children:"blue"}),s=Object(f.jsx)("em",{style:{color:"#8db600"},children:"green"}),o=Object(f.jsx)("em",{style:{color:"#F50257"},children:"pink"}),c=function(t,e){return Object(f.jsx)(L.a,{style:{backgroundColor:"#56A8C7",color:"black"},title:Object(f.jsx)(B.a,{children:Object(f.jsx)(E.a,{children:e})}),placement:"top",arrow:!0,children:t})},l=function(t){return Object(f.jsx)(M.a,{variant:"h3",children:t})},h=function(t){return Object(f.jsx)(M.a,{variant:"h4",children:t})},d=Object(f.jsxs)(D.a,{children:[Object(f.jsx)("br",{}),Object(f.jsx)(N.Element,{name:"article",children:l("Introduction")}),Object(f.jsx)(P.a,{}),Object(f.jsx)("br",{}),Object(f.jsxs)(M.a,{variant:"h6",children:[Object(f.jsx)("b",{children:"Backprop"}),"agation is one of the most important concepts in neural networks, however, it is challenging for learners to understand its concept because it is the most notation heavy part. Luckily, when the layers of notation are pealed back, the simplicity of backprop is revealed. Backprop is just a very simple process to tell us which parameters to change in a neural network.",Object(f.jsx)("br",{}),Object(f.jsx)("br",{}),"For the remainder of the article, by marrying explanation, notation, and interactive tools, the aim is to get a understanding of the foundations. Note that throughout the article there will be"," ",c(Object(f.jsx)("span",{children:"highlighted"}),Object(f.jsx)(M.a,{variant:"h6",children:"Example explanation"}))," ","words that will give extra explanation on mouse over."]}),Object(f.jsx)("br",{}),Object(f.jsx)(N.Element,{name:"oneNeuron",children:l("Backprop on a Linear Problem")}),Object(f.jsx)(P.a,{}),Object(f.jsx)(N.Element,{name:"getting",children:h("Getting Started")}),Object(f.jsxs)(M.a,{variant:"h6",children:["The goal in a neural network, or any optimization problem for that matter, is to lower and minimize whatever"," ",c(Object(f.jsx)("span",{children:"loss"}),Object(f.jsxs)(M.a,{variant:"body1",children:["Error between predicted values ",A("\\hat{y}")," and true values ",A("y")]}))," ","function we define. For this article, we will be performing regression and using mean squared error loss"," ",c(Object(f.jsx)("span",{children:"MSE"}),Object(f.jsxs)(D.a,{children:[Object(f.jsx)(M.a,{variant:"h6",children:F("\\text{MSE} = \\frac{1}{J}\\sum_{i = 1}^{J}(\\hat{y_i} - y_i)^2")}),Object(f.jsxs)(M.a,{variant:"body1",children:[Object(f.jsx)("b",{children:"Input Variables"}),Object(f.jsx)("br",{}),"length of data ",A("J"),Object(f.jsx)("br",{}),"index ",A("i"),Object(f.jsx)("br",{}),"predicted values ",A("\\hat{y}"),Object(f.jsx)("br",{}),"true values ",A("y")]})]})),"."]}),Object(f.jsxs)(M.a,{variant:"h6",children:["Before hitting the calculus, tune the"," ",c(Object(f.jsx)("span",{children:"weight and bias on one neuron"}),Object(f.jsxs)(D.a,{children:[Object(f.jsx)(M.a,{variant:"h6",children:F("\\text{neuron}(x) = w_0x + b ")}),Object(f.jsxs)(M.a,{variant:"body1",children:[Object(f.jsx)("b",{children:"Neuron as a Function"}),Object(f.jsx)("br",{}),"input ",A("x"),Object(f.jsx)("br",{}),"output ",A("\\text{neuron}(x)"),Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:"Tunable Parameters"}),Object(f.jsx)("br",{}),"weight ",A("w_0"),Object(f.jsx)("br",{}),"bias ",A("b")]})]}))," ","by dragging the slider. By observing changes in the"," ",Object(f.jsx)("em",{style:{color:"red"},children:"loss"}),", try to make it reach 0. When you feel like you've lowered the"," ",Object(f.jsx)("em",{style:{color:"red"},children:"loss"})," enough (or need some help), press the"," ",Object(f.jsx)(T.a,{disabled:!0,variant:"outlined",size:"small",style:{borderColor:"#175676",color:"#175676"},children:"Click to reveal the graph"})," ","button below."]}),Object(f.jsx)("br",{}),Object(f.jsx)(N.Element,{name:"structMan",children:Object(f.jsx)(at,{})}),Object(f.jsx)("br",{}),h("Reflection"),Object(f.jsx)(M.a,{variant:"h6",children:Object(f.jsx)("b",{children:"The intuition and logic from the exercise above, is the foundation for what backpropagation and optimization aims to achieve."})}),Object(f.jsx)("br",{}),Object(f.jsxs)(M.a,{variant:"h6",children:["When you start to change the weight, you observe where the loss moves, if it moves up, you move the weight the other direction to lower the loss. This, without the math, is the main principle behind gauging the rate of change and optimizing a neural network. ",Object(f.jsx)("b",{children:"Let's apply this method of thinking!"})]}),Object(f.jsx)("br",{}),Object(f.jsx)(N.Element,{name:"definition",children:h("Defining Backpropagation")}),Object(f.jsxs)(M.a,{variant:"h6",children:["First to get the"," ",c(Object(f.jsx)("span",{children:"instantaneous rate of change"}),Object(f.jsxs)(D.a,{children:[Object(f.jsx)(M.a,{style:{color:r},variant:"h6",children:F("\\lim_{h \\to 0} \\frac{f(x + h) - f(x)}{h}")}),Object(f.jsx)(M.a,{variant:"h6",style:{color:a},children:F("\\frac{df}{dx}")}),Object(f.jsxs)(M.a,{style:{color:r},variant:"body1",children:["Limit definition of derivative of ",A("f(x)")," with respect to ",A("x")]}),Object(f.jsxs)(M.a,{style:{color:a},variant:"body1",children:["Notation for derivative of ",A("f(x)")," with respect to ",A("x")]})]})),"(derivative), we get our point of interest and another point that is infinitely close and calculate slope, this can be visualized as a tangent line at the point of interest for a function with one variable like ",A("f(x)"),"."]}),Object(f.jsx)("br",{}),Object(f.jsxs)(M.a,{variant:"h6",children:["In the context of our one neuron neural network, we can compose the whole network as a nested function",F("\\text{loss}(\\text{neuron}(x,w,b),y)")]}),Object(f.jsxs)(M.a,{variant:"h6",children:["Since want to tune the parameters weight ",A("w")," and bias"," ",A("b"),", we want to know how each parameters will affect the loss, or in other words, the"," ",c(Object(f.jsx)("span",{children:"partial derivative"}),Object(f.jsxs)(D.a,{children:[Object(f.jsx)(M.a,{style:{color:r},variant:"h6",children:F("\\lim_{h \\to 0} \\frac{f(x + h, y) - f(x,y)}{h}")}),Object(f.jsx)(M.a,{variant:"h6",style:{color:a},children:F("\\frac{\\partial f}{\\partial x}")}),Object(f.jsxs)(M.a,{style:{color:r},variant:"body1",children:["Limit definition of partial derivative of"," ",A("f(x,y)")," with respect to ",A("x")]}),Object(f.jsxs)(M.a,{style:{color:a},variant:"body1",children:["Notation for partial derivative of ",A("f(x,y)")," ","with respect to ",A("x")]}),Object(f.jsx)(M.a,{style:{color:r},variant:"h6",children:F("\\lim_{h \\to 0} \\frac{f(x, y + h) - f(x,y)}{h}")}),Object(f.jsx)(M.a,{variant:"h6",style:{color:a},children:F("\\frac{\\partial f}{\\partial y}")}),Object(f.jsxs)(M.a,{style:{color:r},variant:"body1",children:["Limit definition of partial Derivative of"," ",A("f(x,y)")," with respect to ",A("y")]}),Object(f.jsxs)(M.a,{style:{color:a},variant:"body1",children:["Notation for partial derivative of ",A("f(x,y)")," ","with respect to ",A("y")]})]}))," ","of loss with respect to each parameter, also called the"," ",c(Object(f.jsx)("span",{children:"gradient"}),Object(f.jsx)(D.a,{children:Object(f.jsx)(M.a,{variant:"h6",children:F("\\nabla f(x,y) = \\begin{bmatrix} \\frac{\\partial f}{\\partial x} \\\\[4pt] \\frac{\\partial f}{\\partial y} \\\\ \\end{bmatrix}")})})),". By computing the"," ",c(Object(f.jsx)("span",{children:"gradient of loss"}),Object(f.jsx)(M.a,{variant:"h6",children:F("\\nabla \\text{loss} = \\begin{bmatrix} \\frac{ \\partial \\text{loss}}{\\partial w} \\\\[4pt] \\frac{ \\partial \\text{loss}}{\\partial b} \\\\ \\end{bmatrix}")})),", we effectively have gauged how changing each parameter will affect the loss: the direction of steepest ascent. But we want to lower loss, therefore we use the opposite direction to get the direction of steepest descent, to perform"," ",c(Object(f.jsx)("span",{children:"gradient descent"}),Object(f.jsxs)(D.a,{children:[Object(f.jsx)(M.a,{variant:"body1",children:A("\\text{param} := \\text{param} -lr \\cdot \\frac{\\partial \\text{loss}}{\\partial \\text{param}}")}),Object(f.jsx)("br",{}),Object(f.jsxs)(M.a,{variant:"body2",children:["Since the gradient of the loss will be the direction of steepest ",Object(f.jsx)("em",{children:"ascent"}),", by going the opposite direction, we go in the direction of steepest"," ",Object(f.jsx)("em",{children:"descent"}),". Learning rate lr then decides how large of a step in the direction of steepest descent would like."]})]})),"."]}),Object(f.jsx)("br",{}),Object(f.jsxs)(M.a,{variant:"h6",children:["This step is can be visualized by graphing out a loss function. Let's graph the Mean Squared error loss function with same data that will show up later (stay tuned). The contour plot"," ",Object(f.jsx)("b",{children:"below"})," is the result."]}),Object(f.jsx)("center",{children:Object(f.jsx)("img",{src:jt,alt:"contour-explained",width:"500px"})}),Object(f.jsxs)(M.a,{variant:"h6",children:["This plot shows the different"," ",Object(f.jsx)("span",{style:{color:"red"},children:"losses"})," represented by colors descending down from the"," ",Object(f.jsx)("span",{style:{backgroundColor:"black",color:"#5FCABC"},children:"greens"}),", to the"," ",Object(f.jsx)("span",{style:{backgroundColor:"black",color:"#4E9AD9"},children:"blues"}),", to the"," ",Object(f.jsx)("span",{style:{backgroundColor:"black",color:"#6745A4"},children:"purples"}),", down to a ",Object(f.jsx)("span",{style:{color:"red"},children:"loss"})," of 0 in"," ",Object(f.jsx)("span",{style:{backgroundColor:"black",color:"white"},children:"white"}),". It also shows the weights represented by the ",Object(f.jsx)("b",{children:"x axis"})," and biases represented by the ",Object(f.jsx)("b",{children:"y axis"}),". For example if you have a weight=-1 and bias=5 ",Object(f.jsx)("b",{children:"the point of (-1, 5) on the plot"}),", we see that the loss is 0.0 (white on the contour); that would be the place we want to eventually get to. You could also think of it as a physical hole where the colors represent depth. You might already see how we could take small steps down the hole till we reach the bottom where loss is minimized."," "]}),Object(f.jsx)("br",{}),Object(f.jsxs)(M.a,{variant:"h6",children:["The idea of gradient descent for optimization is ",Object(f.jsx)("b",{children:"below"})," ","starting with ",Object(f.jsx)("b",{children:"1)"})]}),Object(f.jsx)("br",{}),Object(f.jsx)("center",{children:Object(f.jsx)("img",{src:bt,alt:"gradient-descent-explained",width:"75%"})}),Object(f.jsxs)(M.a,{variant:"h6",children:["And thats all there is to gradient descent! ",Object(f.jsx)("b",{children:"1)"})," Start with a point, get the ",Object(f.jsx)("b",{children:"2)"})," steepest ascent, ",Object(f.jsx)("b",{children:"3)"})," flip it to reflect the steepest descent, then ",Object(f.jsx)("b",{children:"4)"})," take a step in that direction. After doing this enough times, we will reach the minimum loss possible."]}),Object(f.jsx)("br",{}),Object(f.jsxs)(M.a,{variant:"h6",children:["The question then becomes, how can we calculate the gradient? To answer that, we need a bit of calculus to calculate all the derivatives with respect to the loss. Mainly you will need to use the ",Object(f.jsx)("b",{children:"chain rule"})," from calculus because of the nature of the function we've composed."]}),Object(f.jsx)("br",{}),Object(f.jsx)("br",{}),Object(f.jsxs)(M.a,{variant:"h6",children:[" ","Below is a color coded example of the ",Object(f.jsx)("b",{children:"chain rule."})," Start by sliding the slider and notice how the output is the input to the next function and so forth."," ",Object(f.jsx)("b",{children:"Then read the explanation below"}),"."]}),Object(f.jsx)("br",{}),Object(f.jsx)(D.a,{display:"flex",justifyContent:"center",children:Object(f.jsx)(D.a,{children:Object(f.jsx)(nt,{})})}),Object(f.jsx)("br",{}),Object(f.jsxs)(M.a,{variant:"h6",children:[Object(f.jsxs)("b",{children:["Suppose we wanted to see how ",i," was affected by"," ",o,"."]}),Object(f.jsx)("br",{}),"First lets start at ",i,", then",Object(f.jsxs)("ol",{children:[Object(f.jsxs)("li",{children:["observe how ",i," was affected by ",n]}),Object(f.jsxs)("li",{children:["observe how ",n," was affected by ",s]}),Object(f.jsxs)("li",{children:["observe how ",s," was affected by ",o]})]}),"By chaining these observations together, we get how how ",i," ","was affected by ",o,"."]}),Object(f.jsx)("br",{}),Object(f.jsx)(M.a,{variant:"h6",children:Object(f.jsx)("b",{children:"This logic applied to our one neuron neural network looks like"})}),Object(f.jsxs)(M.a,{variant:"h6",children:[F("\\frac{ \\partial \\text{loss}}{\\partial w} = \\frac{ \\partial \\text{loss}}{\\partial \\text{neuron}} \\frac{ \\partial \\text{neuron}}{\\partial w} "),F("\\frac{ \\partial \\text{loss}}{\\partial b} = \\frac{ \\partial \\text{loss}}{\\partial \\text{neuron}} \\frac{ \\partial \\text{neuron}}{\\partial b} ")]}),Object(f.jsxs)(M.a,{variant:"h6",children:["These chains can be broken up into more intermediate derivatives all the way down to their primitives (basis of automatic differentiation). ",Object(f.jsx)("b",{children:"The main takeaway"})," is that we first observe how the loss output was affected by the neuron output"," ",A(" \\frac{ \\partial \\text{loss}}{\\partial \\text{neuron}}"),", then we observe how the neuron output was affected by each parameter"," ",A(" \\frac{ \\partial \\text{neuron}}{\\partial \\text{parameter}}")," ","and can chain these to observe how the loss was affected by the parameter"," ",A(" \\frac{ \\partial \\text{loss}}{\\partial \\text{parameter}}"),". Notice that we compute these derivatives going ",Object(f.jsx)("b",{children:"backward"})," ","(where the term ",Object(f.jsx)("b",{children:"back"}),"propagation comes from), which has the added benefit of reusing values computed in the forward propagation (for more on this check out"," ",(t="https://rufflewind.com/2016-12-30/reverse-mode-automatic-differentiation",e="reverse mode automatic differentiation",Object(f.jsx)(T.a,{size:"small",style:{color:"#155676"},href:t,target:"_blank",rel:"noopener noreferrer",children:e})),")."]}),Object(f.jsx)("br",{}),Object(f.jsx)(N.Element,{name:"concrete",children:h("Concrete Example")}),Object(f.jsxs)(M.a,{variant:"h6",children:["Let's go through a concrete example of forward propagation, then an emphasis on backward propagation. The training example will be (",A("x = 2.1"),", ",A("y = 4"),"), the weight will be"," ",A("w = 1"),", and the bias will be ",A("b = 0"),". ",A("\\hat{y}")," ","represents the neuron output and predicted value, and"," ",A("\\text{loss}")," represents squared error loss."]}),Object(f.jsx)("br",{}),Object(f.jsx)(it,{title:Object(f.jsx)(M.a,{variant:"h5",children:"Forward Overview"}),noKeySVG:ct,keySVG:ot}),Object(f.jsx)("br",{}),Object(f.jsx)(M.a,{variant:"h5",children:"Forward Computation"}),Object(f.jsx)("img",{src:lt,width:"100%",alt:"forward computation"}),Object(f.jsx)("br",{}),Object(f.jsxs)(M.a,{variant:"h6",children:["Now we can go backward and compute partial derivatives with the chain rule to get the ",A("\\nabla \\text{loss}")]}),Object(f.jsx)("br",{}),Object(f.jsx)(it,{title:Object(f.jsx)(M.a,{variant:"h5",children:"Backward Overview"}),noKeySVG:dt,keySVG:ht}),Object(f.jsx)("br",{}),Object(f.jsx)(M.a,{variant:"h5",children:"Backward Computation"}),Object(f.jsx)("img",{src:ut,width:"100%",alt:"backward computation"}),Object(f.jsxs)(M.a,{variant:"h5",children:[F("\\frac{\\partial \\text{loss}}{\\partial w} = -7.98"),F("\\frac{\\partial \\text{loss}}{\\partial b} = -3.8")]}),Object(f.jsxs)(M.a,{variant:"h6",children:["Then, we update the parameters with opposite gradient to descend loss, in this case learning rate is ",A("\\text{lr} = 0.01"),F("w := w - \\text{lr} \\cdot \\frac{\\partial \\text{loss}}{\\partial w} = (1) - (0.01) \\cdot (-7.98) = 1.0798"),F("b := b - \\text{lr} \\cdot \\frac{\\partial \\text{loss}}{\\partial b} = (0) - (0.01) \\cdot (-3.8) = 0.038 "),Object(f.jsx)("b",{children:"To see how well our tuned parameters do, let's do one more forward pass"}),F("\\text{loss} = ((1.0798)(2.1) + 0.038) - 4)^2 = 2.87")]}),Object(f.jsxs)(M.a,{variant:"h6",children:["Total loss decrease of ",A("3.61 - 2.87 = 0.74"),". Loss went down!"]}),Object(f.jsx)("br",{}),Object(f.jsx)(N.Element,{name:"see1",children:h("See it in Action")}),Object(f.jsxs)(M.a,{variant:"h6",children:["To see the what we just did (forward, backward, update) on more data and on the entire batch as opposed to a single training example, press"," ",Object(f.jsx)(W.a,{style:{background:"#175676",color:"white"},size:"small",disabled:!0,children:Object(f.jsx)(R.a,{fontSize:"small"})})," ","to start the training process. Watch how as the line gets better fit, the loss decreases."]}),Object(f.jsx)(N.Element,{name:"structLin",children:Object(f.jsx)(tt,{})}),Object(f.jsx)("br",{}),Object(f.jsx)(N.Element,{name:"scaling",children:l("Backprop on a Non-Linear Problem")}),Object(f.jsx)(P.a,{}),Object(f.jsx)(N.Element,{name:"changes",children:h("The Changes")}),Object(f.jsxs)(M.a,{variant:"h6",children:["To fit more interesting data that is non-linear (e.g. sine wave or quadratic), we need to add complexity to vary output to make sure we are not constrained to only linear outputs. We can do this by adding more neurons per layer, more layers, and adding non-linearities (activation functions) to the outputs. If you think of our entire neural network as a function, then by adding more neurons and more layers we are creating a more nested function. Not only does this create more parameters that we can tune to vary the output, it also maintains the property of"," ",c(Object(f.jsx)("span",{children:"differentiability"}),Object(f.jsx)(D.a,{children:Object(f.jsx)(M.a,{variant:"h6",children:"The derivative exists for all inputs"})})),": important so we can compute the gradient. And by adding non-linear activation functions with points of deactivation, certain neurons may have no effect on the output while others may become more activated, contributing to outputs that don't have to follow linear constraints. We will be using the"," ",c(Object(f.jsx)("span",{children:"ReLU"}),Object(f.jsxs)(D.a,{children:[Object(f.jsxs)(M.a,{variant:"h6",children:[Object(f.jsx)("b",{children:"Re"}),"ctified ",Object(f.jsx)("b",{children:"L"}),"inear ",Object(f.jsx)("b",{children:"U"}),"nit"]}),Object(f.jsx)(M.a,{variant:"h6",children:A(" \\text{ReLU}(x) = \\left\\{ \\begin{array}{ll} 0 & x\\leq 0  \\\\ x & x > 0 \\\\ \\end{array} \\right. ")})]}))," ","activation function in the hidden layers."]}),Object(f.jsx)(D.a,{display:"flex",justifyContent:"center",children:Object(f.jsx)(D.a,{children:Object(f.jsx)("img",{alt:"summary",src:st,width:"100%"})})}),Object(f.jsxs)(M.a,{variant:"h6",children:[Object(f.jsx)("b",{children:"Above"})," is an example of a neural network with one input, three hidden layers with eight neurons each, and one output neuron. The output of each neuron is fed into the neurons of the next layer and so forth (like a nested function). Each link represents a weight and a corresponding input into the respective neuron: notice how the more neurons we add, the more connections there are and the more parameters we can tune to get our desired output."]}),Object(f.jsx)("br",{}),Object(f.jsx)(N.Element,{name:"training",children:h("Training Process")}),Object(f.jsx)(M.a,{variant:"h6",children:Object(f.jsxs)("ol",{children:[Object(f.jsx)("li",{children:"Forward propagation resulting in an output and loss"}),Object(f.jsx)("li",{children:"Backward propagation using the chain rule to compute the gradient"}),Object(f.jsx)("li",{children:"Descend the loss by performing gradient descent"})]})}),Object(f.jsxs)(M.a,{variant:"h6",children:[Object(f.jsx)("b",{children:"The process doesn't change from the single neuron example!"})," ","Since the network is deeper, we have to calculate more derivatives going backwards and have to tune more parameters with gradient descent, but the logic stays the same."]}),Object(f.jsx)("br",{}),Object(f.jsxs)(M.a,{variant:"h6",children:["A great way to visualize backpropagation in a large network is with vertical arrows representing which direction we need to nudge the neuron output in order to lower loss:"," ",A("-\\frac{\\partial \\text{loss}}{\\partial \\text{activation} }"),". In the neural network below, you will be able to visualize all phases of a single epoch with an emphasis on"," ",Object(f.jsx)("b",{children:"backpropagation"}),". Read the instructions below to get a quick start!"]}),Object(f.jsx)("br",{}),Object(f.jsx)(N.Element,{name:"see2",children:Object(f.jsx)(M.a,{variant:"h4",children:"Backprop Explainer Quick Start"})}),Object(f.jsx)(M.a,{variant:"h6",children:Object(f.jsxs)("ol",{children:[Object(f.jsxs)("li",{children:["Press"," ",Object(f.jsx)(W.a,{style:{background:"#175676",color:"white"},size:"small",disabled:!0,children:Object(f.jsx)(R.a,{fontSize:"small"})})," ","to start training"]}),Object(f.jsxs)("li",{children:["Then press"," ",Object(f.jsx)(T.a,{variant:"outlined",size:"small",style:{borderColor:"#175676",color:"#175676"},disabled:!0,children:"Click to animate epoch #"})," ","to see forward propagation, ",Object(f.jsx)("b",{children:"backward propagation"}),", and update animation at the epoch #"]}),Object(f.jsxs)("li",{children:["To go back to fitting mode click"," ",Object(f.jsxs)(T.a,{variant:"outlined",size:"small",style:{borderColor:"#175676",color:"#175676"},disabled:!0,children:[Object(f.jsx)(z.a,{})," Go back to fitting"]})," "]})]})}),Object(f.jsxs)(M.a,{variant:"h6",children:[Object(f.jsx)("b",{children:" Click on "}),Object(f.jsx)(_.a,{variant:"small",style:{color:"#FFA500"}})," ",Object(f.jsx)("b",{children:"to reveal extra descriptions"})]}),Object(f.jsx)("br",{})]});return Object(f.jsx)(D.a,{justifyContent:"center",display:"flex",children:Object(f.jsx)(D.a,{maxWidth:"60%",children:d})})},xt=(a.p,a(21)),ft=a(268),mt=a.n(ft),yt=a(642),gt=a(639),Ot=a(632),vt=a(634),wt=a(631),kt=a(633),St=a.p+"static/media/singleSummary.8525cefd.svg",Ct=a.p+"static/media/epochMode.0ae87189.png",At=a.p+"static/media/key.a581ba62.svg",Ft=function(){function t(e,a){Object(l.a)(this,t),this.weights=e,this.bias=a}return Object(h.a)(t,[{key:"mult",value:function(t,e){return t.map((function(t,a){return t*e[a]}))}},{key:"dMult",value:function(t,e){return this.mult(t,e)}},{key:"sum",value:function(t){return t.reduce((function(t,e){return t+e}))}},{key:"dSum",value:function(t,e){for(var a=[],r=0;r<e;r++)a.push(t);return a}},{key:"linear",value:function(t){return t}},{key:"forward",value:function(t,e){var a=this.weights,r=this.bias,n=this.mult,i=this.sum,s=n(t,a),o=i(s)+r,c=e(o);this.inputs=t,this.multStep=s,this.sumStep=o,this.actStep=c,this.output=c}},{key:"backward",value:function(t,e){var a=this.inputs,r=this.weights,n=this.actStep,i=this.dSum,s=this.mult,o=this.sum,c=e(n)*t,l=i(c,a.length),h=c,d=s(l,a),u=s(l,r),j=o(u);this.dvalue=t,this.dActStep=c,this.dSumStep=l,this.dBias=h,this.dWeights=d,this.dInputs=u,this.dInputsSum=j}}]),t}(),Tt=function(){function t(){Object(l.a)(this,t)}return Object(h.a)(t,[{key:"forward",value:function(t,e){var a=t-e,r=this.output=Math.pow(t-e,2);this.subStep=a,this.squareStep=r,this.output=r}},{key:"backward",value:function(){this.dInputs=2*this.subStep}}]),t}(),Lt=function(){function t(e,a,r){Object(l.a)(this,t),this.model=[],this.loss=new Tt,this.shape=e;for(var n=0;n<a.length;n++){for(var i=[],s=0;s<a[n].length;s++)i.push(new Ft(a[n][s],r[n][s]));this.model.push(i)}}return Object(h.a)(t,[{key:"sum",value:function(t){return t.reduce((function(t,e){return t+e}))}},{key:"add",value:function(t,e){var a=t.length,r=e.length;if(r!==a)return console.error("".concat(a," does not match ").concat(r,", so returned empty array")),[];for(var n=new Array(a),i=0;i<t.length;i++)n[i]=t[i]+e[i];return n}},{key:"zeros",value:function(t){for(var e=new Array(t),a=0;a<t;a++)e[a]=0;return e}},{key:"dReLU",value:function(t){return t>0?1:0}},{key:"dLinear",value:function(t){return 1}},{key:"ReLU",value:function(t){return Math.max(0,t)}},{key:"linear",value:function(t){return t}},{key:"forward",value:function(t,e){for(var a=[t],r=this.model.length,n=0;n<r-1;n++){for(var i=[],s=0;s<this.model[n].length;s++)this.model[n][s].forward(a,this.ReLU),i.push(this.model[n][s].output);a=i}this.model[r-1][0].forward(a,this.linear),this.yhat=this.model[r-1][0].output,this.loss.forward(this.yhat,e)}},{key:"backward",value:function(){var t=this.add,e=this.zeros;this.loss.backward();var a=[this.loss.dInputs],r=this.model.length;this.model[r-1][0].backward(a[0],this.dLinear),a=this.model[r-1][0].dInputs;for(var n=r-2;n>=0;n--){for(var i=e(this.model[n][0].inputs.length),s=0;s<this.model[n].length;s++)this.model[n][s].backward(a[s],this.dReLU),i=t(i,this.model[n][s].dInputs);a=i}}},{key:"update",value:function(t){for(var e=function(t,e,a){return t-e*a},a=0;a<this.model.length;a++)for(var r=0;r<this.model[a].length;r++)for(var n=0;n<this.model[a][r].dWeights.length;n++){var i=e(this.model[a][r].weights[n],t,this.model[a][r].dWeights[n]),s=e(this.model[a][r].bias,t,this.model[a][r].dBias);this.model[a][r].weights[n]=i,this.model[a][r].bias=s}}}]),t}();function Bt(t,e){for(var a=[],r=0;r<t.length;r++){for(var n=e[r+1],i=[],s=0;s<n;s++){for(var o=[],c=s;c<t[r].length;c+=n)o.push(t[r][c]);i.push(o)}a.push(i)}return a}function Et(t,e){for(var a=0;a<t.length;a++)for(var r=0;r<t[a].length;r++)t[a][r]=+t[a][r].toFixed(e);return t}function Mt(t){for(var e=[],a=0;a<t.length;a++)for(var r=0;r<t[a].length;r++)e.push(t[a][r]);return e}function Dt(t){return Math.floor(Math.random()*Math.floor(t))}function Pt(t){return Array.from(t.dataSync())}function Wt(t,e){return{xScale:x.r().domain(t.domain).range(t.range),yScale:x.r().domain(e.domain).range(e.range)}}function Rt(t){return x.m().x((function(e){return e.x+t})).y((function(e){return e.y+t}))}function zt(t,e,a,r,n,i,s){var o=[];o.push([r]);for(var c=1;c<t.length-1;c++){for(var l=[],h=0;h<t[c];h++){var d={x:i(e[c])-a/2,y:s(92-12*h)-a/2};l.push(d)}o.push(l)}return o.push([n]),o}function _t(t,e,a){for(var r=[],n=[],i=[],s=1;s<t.length;s++){i=[];for(var o=0;o<t[s];o++){r=[];for(var c=0;c<t[s-1];c++)r.push(a({source:e[s-1][c],target:e[s][o]}));i.push(r)}n.push(i)}return n}i.Component,a(635),a.p;var Nt=a(398),qt=a(128),It=function(){return Object(f.jsx)(N.Element,{name:"structMan",children:Object(f.jsx)(at,{})})},Ut=350,Xt=Object(b.a)({overrides:{MuiTypography:{h1:{fontWeight:Ut},h2:{fontWeight:Ut},h3:{marginTop:25,fontWeight:Ut},h4:{marginTop:20,marginBottom:10,fontWeight:Ut},h5:{fontWeight:Ut},h6:{fontWeight:Ut},body1:{fontWeight:Ut},body2:{fontWeight:Ut}}}}),Gt=function(t){Object(d.a)(a,t);var e=Object(u.a)(a);function a(){return Object(l.a)(this,a),e.apply(this,arguments)}return Object(h.a)(a,[{key:"componentDidMount",value:function(){j.a.initialize("".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/bp-demo",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_GAID)),j.a.pageview("/")}},{key:"render",value:function(){return Object(f.jsx)(p.a,{theme:Xt,children:Object(f.jsxs)(Nt.a,{children:[" ",Object(f.jsxs)("div",{children:[Object(f.jsx)("br",{}),Object(f.jsxs)(qt.c,{children:[" ",Object(f.jsx)(qt.a,{exact:!0,path:"/",component:pt}),Object(f.jsx)(qt.a,{exact:!0,path:"/newpage",component:It})," "]}),Object(f.jsx)("br",{})]})]})})}}]),a}(i.Component),Vt=(a(597),function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,645)).then((function(e){var a=e.getCLS,r=e.getFID,n=e.getFCP,i=e.getLCP,s=e.getTTFB;a(t),r(t),n(t),i(t),s(t)}))});c.a.render(Object(f.jsx)(s.a.StrictMode,{children:Object(f.jsx)(Gt,{})}),document.getElementById("root")),Vt()}},[[598,1,2]]]);
//# sourceMappingURL=main.bf5958e0.chunk.js.map